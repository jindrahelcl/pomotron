{% extends "base.html" %}

{% block title %}Agenti - StoryTRON{% endblock %}

{% block content %}
<div class="card">
    <h2>ğŸ¤– SprÃ¡va agentÅ¯</h2>
    <p>PÅ™epÃ­nÃ¡nÃ­ mezi rÅ¯znÃ½mi AI agenty v StoryTRON systÃ©mu.</p>
</div>

{% if agents and agents.agents %}
<div class="agent-grid">
    {% for agent in agents.agents %}
    <div class="agent-card {% if agent.id == agents.active_agent %}active{% endif %}">
        <h3>{{ agent.name }}</h3>
        <p><strong>ID:</strong> <code>{{ agent.id }}</code></p>
        <p>{{ agent.description }}</p>

        {% if agent.id == agents.active_agent %}
            <div style="margin-top: 15px;">
                <span style="color: #00ff00; font-weight: bold;">âœ… AKTIVNÃ AGENT</span>
            </div>
        {% else %}
            <form method="POST" action="{{ url_for('web_switch_agent') }}" style="margin-top: 15px;">
                <input type="hidden" name="agent_id" value="{{ agent.id }}">
                <button type="submit" class="btn" onclick="return confirm('Chcete pÅ™epnout na agenta {{ agent.name }}?')">
                    ğŸ”„ Aktivovat agenta
                </button>
            </form>
        {% endif %}
    </div>
    {% endfor %}
</div>

<div class="card">
    <h2>â„¹ï¸ Informace o agentech</h2>
    <p><strong>AktuÃ¡lnÄ› aktivnÃ­:</strong> {{ agents.active_agent }}</p>
    <p><strong>Celkem dostupnÃ½ch:</strong> {{ agents.agents|length }}</p>
    <p><strong>PoslednÃ­Ã­ aktualizace:</strong> {{ moment().format('HH:mm:ss') if moment else 'N/A' }}</p>
</div>

{% else %}
<div class="card error">
    <h2>âŒ NepodaÅ™ilo se naÄÃ­st agenty</h2>
    <p>Nelze se pÅ™ipojit k StoryTRON API pro zÃ­skÃ¡nÃ­ seznamu agentÅ¯.</p>
    <button class="btn" onclick="location.reload()">ğŸ”„ Zkusit znovu</button>
</div>
{% endif %}

<div class="card">
    <h2>ğŸ® Akce</h2>
    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
        <button class="btn" onclick="location.reload()">ğŸ”„ Obnovit seznam</button>
        <a href="{{ url_for('dashboard') }}" class="btn">ğŸ“Š ZpÄ›t na dashboard</a>
        <a href="{{ url_for('web_chat') }}" class="btn">ğŸ’¬ Test chat</a>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
// Auto-refresh kaÅ¾dÃ½ch 10 sekund
setInterval(() => {
    location.reload();
}, 10000);
</script>
{% endblock %}
